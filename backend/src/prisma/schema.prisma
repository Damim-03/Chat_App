generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model User {
  id         String        @id @default(uuid())
  fullName   String
  username   String        @unique
  password   String
  gender     Gender
  profilePic String?       @default("")
  createdAt  DateTime      @default(now())
  updatedAt  DateTime      @updatedAt

  // Relations
  conversations Conversation[] @relation("UserConversations")
  messagesSent   Message[]      @relation("MessagesSent")
  messagesReceived Message[]    @relation("MessagesReceived")
}

model Conversation {
  id            String      @id @default(uuid())
  createdAt     DateTime    @default(now())
  updatedAt     DateTime    @updatedAt

  // Relations
  participants User[]   @relation("UserConversations")
  messages     Message[]
}

model Message {
  id             String       @id @default(uuid())
  message        String
  createdAt      DateTime     @default(now())
  updatedAt      DateTime     @updatedAt

  // Relations
  senderId       String
  receiverId     String
  conversationId String?

  sender        User         @relation("MessagesSent", fields: [senderId], references: [id])
  receiver      User         @relation("MessagesReceived", fields: [receiverId], references: [id])
  conversation  Conversation? @relation(fields: [conversationId], references: [id])
}

enum Gender {
  male
  female
}
